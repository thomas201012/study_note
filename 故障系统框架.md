# 故障系统框架
## 实现方案
- 在运行过程中产生故障时，接收生成的状态码或异常处理信息
- 将接收到的信息或信息组合在故障对照表中进行查询，得到自定义的状态码
- 根据状态码生成时系统处于的状态来决定故障通知的显示方式
- 根据显示方式来调用对应的通知接口
- 在用户确认或故障恢复后清除对应产生的故障通知
## 需要监控的模块
- Wi-Fi
- ETH
- BLE
- CoAP
- 系统故障
## 捕获故障的方式
- 状态码
    - 记录前20个状态码，并在其中通过递归的方式找到对应的自定义状态码
- 异常处理(try except)
    - 记录前5个传入的异常处理信息，并通过递归的方式找到对应的自定义状态码
- 程序逻辑
    - 直接生成对应的自定义状态码
## 生成故障码接口
- 对应不同捕获故障的方式有不同的接口，接口将捕获到的故障进行递归查找后得到自定义的故障码
## 故障通知接口
- 在故障码生成后调用
- 决定了在哪个级别中显示
    - 在app中
    - 在通用的错误展示界面中
## 其他
- 在故障恢复后，将自动清除掉当前显示状态的错误码
- 在产生了多个异常状态码时只通知第一个生成的错误码，清除当前记录的所有状态码，并在有新的状态码传入后进行比对，确保只展示之前未出现过的错误码，比对内容在网络恢复或重启后删除。
- 对于找不到自定义状态码的故障，显示为未知异常状态码，并将该故障状态产生时的日志存入文件中，通过CoAP或BLE上传日志。
## 待解决问题
- 异常处理信息的获取方式
    - 在异常日志打印时捕获
        优点：不需要在所有异常处理部分进行代码增加就可以捕获到所有的异常处理信息
        缺点：需要对lib里的logging.py修改
- 故障状态产生时日志的获取和保存方式
- 在显示错误信息到用户确认期间生成新的错误码该保留还是清除。
